# 4

## 1. Kasiski 检验

明文相同 -> 密钥值也相同，

那么明文中使用频率最高的是 T,H,E。也就是定冠词。

由此可以相信频率最高的三个字母就是 THE加密的。

![1](./img/4-1.png)

CHR 出现的位置分别是 1 166 236 276 286.

求其公因数，比如是 5。

那么就把整个密文以 5 分组。

比如第一组为：CVAB……

第二组为：HOEI……

……

然后将每一组中的频率。



把原本 A 的频率和现在算出来的 A 的频率做乘法……

![3](./img/4-3.png)

直到 Z，得到一个频率，这里是 0.035。（专门针对维吉尼亚加密算法，因为其是一个移位算法）

![2](./img/4-2.png)

可以看到是 0.061，0.069，0.066，0.060，0.072。

![4](./img/4-4.png)

如果猜对了，真正准确的概率是 0.065，而错误的话平均为 0.038。差距很大，很明显。



## 2. Hill 密文

比如 明文 friday，如果被加密成 PQCFKU

friday是明文，密钥假设为 K，那么就可以有：

![5](./img/4-5.png)

一定要已知明文，不知道明文的话，难度很大。



## 3. 流密码

LFSR 线性反馈移位寄存器。

LFSR stream cipher。

相同的输入得到不同的输出，其中有内部状态。和时序电路类似。

密钥长度非常长，有专门的密钥生成器，利用相同的密钥加密和解密。

1. 那么密钥就分有加密和解密，它们是加密时同步产生的。相同的程序，相同的 seed。这个被称为同步密码流。
2. 密钥生成是根据明文自动改变的，密钥不断改变，只有把密文传给另一方，才知道密钥的形式，被称作异步密码流。

（其中把密文当成下一个密钥的被称作自动密码流）





![6](./img/4-6.png)

这就是线性反馈移位寄存器。可以使用电路实现，所以很快。

每个寄存器 ki 都需要一个初始值。下一个值根据异或产生。

比如一开始是 1000。

那么 k1 = 1，k2 = 0，异或之后得到 1，给 k4。整体向左移一位。k1 的 1 被移出。

变成了 0001。

所以就整个序列就是 100010010101111000……



（具体的解法一定要去看。）

前面还可以乘一个系数，那么这个系数就必须通过已知明文得知了。



## 3. 香农理论

### 1. 密码学发展的三个里程碑

计算安全性：蒂夫霍尔曼。只需要计算很难达到就行。但或许会有更好的算法。

可证明安全性：只要证明没有更好方法就行。但是现在证不出来。

无条件安全性：香农提出的。完善保密性。针对伪密文分析得出。只知道密文，即使是有无穷的计算能力和存储容量，也无法得出密钥。（一次yimi是什么?）

移位密码对于单字符加密具有完善保密性。

因为无法解密，所以必须要把密钥完整地传送过去。